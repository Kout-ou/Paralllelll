Here is the parallel implementation with OpenMP