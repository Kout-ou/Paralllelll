Here is the parallel implementation with MPI